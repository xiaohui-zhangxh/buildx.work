<!-- Navigation Bar -->
<div class="fixed top-4 left-0 right-0 z-50 flex justify-center px-4">
  <nav
    class="
      navbar bg-base-100/95 backdrop-blur-md text-base-content
      shadow-2xl rounded-full max-w-6xl w-full border border-base-300
      px-6 py-2 min-h-[3.5rem]
    "
  >
    <div class="navbar-start">
      <!-- Mobile Menu Button -->
      <div class="dropdown lg:hidden">
        <div tabindex="0" role="button" class="btn btn-ghost btn-circle">
          <svg
            xmlns="http://www.w3.org/2000/svg"
            class="h-6 w-6"
            fill="none"
            viewBox="0 0 24 24"
            stroke="currentColor"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M4 6h16M4 12h16M4 18h16"
            />
          </svg>
        </div>

        <ul
          tabindex="0"
          class="
            dropdown-content menu bg-base-100 rounded-box z-[1] w-52
            p-2 shadow-xl border border-base-300 mt-2
          "
        >
          <li>
            <%= link_to root_path, class: "text-base-content hover:bg-base-200" do %>
              首页
            <% end %>
          </li>

          <% if authenticated? %>
            <li>
              <%= link_to my_root_path, class: "text-base-content hover:bg-base-200" do %>
                个人中心
              <% end %>
            </li>
            <li>
              <%= link_to my_profile_path, class: "text-base-content hover:bg-base-200" do %>
                个人信息
              <% end %>
            </li>
            <li>
              <%= link_to my_sessions_path, class: "text-base-content hover:bg-base-200" do %>
                登录日志
              <% end %>
            </li>
            <li>
              <%= link_to my_security_path, class: "text-base-content hover:bg-base-200" do %>
                安全设置
              <% end %>
            </li>
            <li>
              <%= link_to session_path, method: :delete, data: { turbo_method: :delete }, class: "text-error hover:bg-base-200" do %>
                退出登录
              <% end %>
            </li>
          <% else %>
            <li>
              <%= link_to "登录", new_session_path, class: "text-base-content hover:bg-base-200" %>
            </li>
            <li>
              <%= link_to "注册", new_user_path, class: "text-base-content hover:bg-base-200" %>
            </li>
          <% end %>
        </ul>
      </div>

      <!-- Brand Logo and Name -->
      <%= link_to root_path, class: "btn btn-ghost px-3 hover:bg-base-200 flex items-center gap-2 rounded-full" do %>
        <%= image_tag "logo-icon.svg", alt: "Tanmer Egg", class: "h-7 w-7" %>

        <span class="text-lg font-bold hidden sm:inline text-base-content">
          Tanmer Egg
        </span>
      <% end %>
    </div>

    <!-- Desktop Navigation -->
    <div class="navbar-center hidden lg:flex">
      <ul class="menu menu-horizontal px-1 gap-1">
        <li>
          <%= link_to root_path, class: "btn btn-ghost hover:bg-base-200 text-base-content rounded-full px-4" do %>
            首页
          <% end %>
        </li>

        <% if authenticated? %>
          <li>
            <%= link_to my_root_path, class: "btn btn-ghost hover:bg-base-200 text-base-content rounded-full px-4" do %>
              个人中心
            <% end %>
          </li>
        <% end %>
      </ul>
    </div>

    <div class="navbar-end gap-2">
      <!-- Theme Toggle Button -->
      <button
        type="button"
        class="btn btn-ghost btn-circle hover:bg-base-200 text-base-content"
        data-action="click->theme#toggle"
        aria-label="切换主题"
      >
        <svg
          xmlns="http://www.w3.org/2000/svg"
          class="h-5 w-5"
          fill="none"
          viewBox="0 0 24 24"
          stroke="currentColor"
          data-theme-target="icon"
        >
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            stroke-width="2"
            d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"
          />
        </svg>
      </button>

      <% if authenticated? %>
        <!-- User Dropdown Menu -->
        <div class="dropdown dropdown-end">
          <div
            tabindex="0"
            role="button"
            class="btn btn-ghost btn-circle avatar hover:bg-base-200"
          >
            <div
              class="
                w-10 h-10 rounded-full bg-primary text-primary-content
                flex items-center justify-center
              "
            >
              <span class="text-sm font-bold">
                <%= current_user&.name&.first&.upcase || current_user&.email_address&.first&.upcase || "U" %>
              </span>
            </div>
          </div>

          <ul
            tabindex="0"
            class="
              dropdown-content menu bg-base-100 rounded-box z-[1] w-52 p-2
              shadow-xl border border-base-300 mt-2
            "
          >
            <li>
              <%= link_to my_root_path, class: "gap-2" do %>
                <svg
                  xmlns="http://www.w3.org/2000/svg"
                  class="h-5 w-5"
                  fill="none"
                  viewBox="0 0 24 24"
                  stroke="currentColor"
                >
                  <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    stroke-width="2"
                    d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"
                  />
                </svg>
                个人中心
              <% end %>
            </li>

            <li>
              <%= link_to my_profile_path, class: "gap-2" do %>
                <svg
                  xmlns="http://www.w3.org/2000/svg"
                  class="h-5 w-5"
                  fill="none"
                  viewBox="0 0 24 24"
                  stroke="currentColor"
                >
                  <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    stroke-width="2"
                    d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"
                  />
                </svg>
                个人信息
              <% end %>
            </li>

            <li>
              <%= link_to my_sessions_path, class: "gap-2" do %>
                <svg
                  xmlns="http://www.w3.org/2000/svg"
                  class="h-5 w-5"
                  fill="none"
                  viewBox="0 0 24 24"
                  stroke="currentColor"
                >
                  <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    stroke-width="2"
                    d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"
                  />
                </svg>
                登录日志
              <% end %>
            </li>

            <li>
              <%= link_to my_security_path, class: "gap-2" do %>
                <svg
                  xmlns="http://www.w3.org/2000/svg"
                  class="h-5 w-5"
                  fill="none"
                  viewBox="0 0 24 24"
                  stroke="currentColor"
                >
                  <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    stroke-width="2"
                    d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"
                  />
                </svg>
                安全设置
              <% end %>
            </li>

            <li>
              <%= link_to session_path, method: :delete, data: { turbo_method: :delete }, class: "gap-2 text-error" do %>
                <svg
                  xmlns="http://www.w3.org/2000/svg"
                  class="h-5 w-5"
                  fill="none"
                  viewBox="0 0 24 24"
                  stroke="currentColor"
                >
                  <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    stroke-width="2"
                    d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"
                  />
                </svg>
                退出登录
              <% end %>
            </li>
          </ul>
        </div>
      <% else %>
        <!-- Login and Register Links -->
        <div class="hidden md:flex gap-2">
          <%= link_to "登录", new_session_path, class: "btn btn-ghost hover:bg-base-200 text-base-content rounded-full px-4" %>
          <%= link_to "注册", new_user_path, class: "btn btn-primary rounded-full px-6" %>
        </div>
      <% end %>
    </div>
  </nav>
</div>
