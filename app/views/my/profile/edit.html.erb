<div class="container mx-auto px-4 py-8">
  <div class="max-w-2xl mx-auto">
    <%= render "shared/flash_messages" %>

    <div class="mb-6">
      <div class="flex justify-between items-center">
        <div>
          <h1 class="text-4xl font-bold">编辑个人信息</h1>
          <p class="text-base-content/70 mt-2">更新您的个人信息</p>
        </div>

        <%= link_to my_profile_path, class: "btn btn-ghost" do %>
          <svg
            xmlns="http://www.w3.org/2000/svg"
            class="h-5 w-5"
            fill="none"
            viewBox="0 0 24 24"
            stroke="currentColor"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M10 19l-7-7m0 0l7-7m-7 7h18"
            />
          </svg>
          返回
        <% end %>
      </div>
    </div>

    <div class="card bg-base-100 shadow-xl">
      <div class="card-body">
        <%= form_with model: @user, url: my_profile_path, method: :patch, local: true, data: { controller: "form", turbo: true } do |form| %>
          <% if @user.errors.any? %>
            <div role="alert" class="alert alert-error mb-5">
              <svg
                xmlns="http://www.w3.org/2000/svg"
                class="stroke-current shrink-0 h-6 w-6"
                fill="none"
                viewBox="0 0 24 24"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z"
                />
              </svg>

              <div>
                <h3 class="font-bold">请修正以下错误：</h3>

                <ul class="list-disc list-inside">
                  <% @user.errors.full_messages.each do |message| %>
                    <li><%= message %></li>
                  <% end %>
                </ul>
              </div>
            </div>
          <% end %>

          <div class="form-control mb-4">
            <%= form.label :name, "姓名", class: "label" %>
            <span class="label-text">姓名</span>
            <%= form.text_field :name, class: "input input-bordered w-full", placeholder: "请输入您的姓名" %>
          </div>

          <div class="form-control mb-4">
            <%= form.label :email_address, "邮箱地址", class: "label" %>
            <span class="label-text">邮箱地址</span>
            <%= form.email_field :email_address, class: "input input-bordered w-full", placeholder: "example@email.com" %>
          </div>

          <div class="form-control mb-4" data-controller="password-strength">
            <%= form.label :password, "新密码（留空则不修改）", class: "label" %>
            <span class="label-text">新密码（留空则不修改）</span>

            <%= form.password_field :password,
                class: "input input-bordered w-full",
                placeholder: "至少 8 位，包含字母和数字",
                data: {
                  password_strength_target: "input",
                  action: "input->password-strength#updateStrength"
                } %>

            <div
              class="w-full bg-base-200 rounded-full h-2 mt-2"
              style="display: none;"
              data-password-strength-target="indicatorContainer"
            >
              <div
                class="h-2 rounded-full transition-all duration-300"
                data-password-strength-target="indicator"
                style="width: 0%;"
              ></div>
            </div>

            <label class="label">
              <span
                class="label-text-alt"
                data-password-strength-target="feedback"
              >
                留空则不修改密码
              </span>
            </label>
          </div>

          <div class="form-control mb-4">
            <%= form.label :password_confirmation, "确认新密码", class: "label" %>
            <span class="label-text">确认新密码</span>
            <%= form.password_field :password_confirmation, class: "input input-bordered w-full", placeholder: "请再次输入新密码" %>
          </div>

          <div class="card-actions justify-end mt-6">
            <%= link_to "取消", my_profile_path, class: "btn btn-ghost" %>

            <button
              type="submit"
              class="btn btn-primary"
              data-form-target="submit"
              data-action="submit->form#submit"
            >
              保存更改
            </button>
          </div>
        <% end %>
      </div>
    </div>
  </div>
</div>
