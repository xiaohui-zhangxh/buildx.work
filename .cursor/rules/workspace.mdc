---
description: BuildX 项目特定规则和文档索引。包含项目文档结构、开发流程、技术栈信息等。
alwaysApply: true
---

# BuildX 项目基础规则

## 📚 文档结构总览

本项目采用分阶段文档管理方式，所有文档按功能模块和开发阶段组织。

### 根目录文档

根目录下的主要文档包括：
- **技术栈说明**：更新 `engines/buildx_core/README.md` 或 `docs/DEVELOPER_GUIDE.md`
- **开发笔记**：更新对应阶段的 `notes.md`
- **记录添加原因和使用场景**：便于后续维护

**注意**：根目录 `README.md` 只做简单介绍和链接，指向 `engines/buildx_core/README.md` 获取详细文档。详细的基础设施文档在 `engines/buildx_core/README.md`。

### 解决技术问题

1. 查看 `docs/experiences/` 目录是否有类似问题的解决方案
2. 查看 `docs/phase-{阶段名}/notes.md` 是否有类似问题
3. 查看 `docs/DEVELOPER_GUIDE.md` 了解技术决策
4. 查看相关 Cursor 规则文件（如 `authentication.mdc`）

### 更新开发进度

1. 更新对应阶段的 `progress.md`
2. 在 `notes.md` 中记录遇到的问题和解决方案
3. 如有技术决策，更新 `docs/DEVELOPER_GUIDE.md`

### 了解项目状态

1. 查看 `CURRENT_WORK.md` 了解当前正在做什么
2. 查看 `docs/DEVELOPMENT_PLAN.md` 了解整体进度
3. 查看各阶段的 `progress.md` 了解详细进度
4. 查看 `docs/FEATURES.md` 了解功能完成情况

### 运行测试和查看覆盖率

1. **运行测试**：`bin/rails test`
2. **查看覆盖率报告**：
   - **用户查看**：`open coverage/index.html`（在浏览器中打开 HTML 报告）
   - **AI 分析**：读取 `coverage/.resultset.json` 文件分析覆盖率数据（AI 无法读取浏览器内容，必须读取 JSON 数据文件）
3. **检查特定文件覆盖率**：使用 `COVERAGE_FILES` 环境变量（详见 `docs/DEVELOPER_GUIDE.md` 测试规范章节）
4. **测试覆盖率要求**：至少 85%（配置在 `test/test_helper.rb`）

**重要**：当需要分析覆盖率数据、找出需要测试的文件时，AI 应该：
- ✅ **读取 JSON 数据文件**：`coverage/.resultset.json`（包含详细的覆盖率数据）
- ✅ **读取元数据文件**：`coverage/.last_run.json`（包含整体覆盖率信息）
- ❌ **不要打开 HTML 文件**：`open coverage/index.html`（AI 无法读取浏览器内容，此命令仅适用于用户手动查看）

## 📝 文档更新规范

### 何时更新文档

1. **技术决策**：更新 `docs/DEVELOPER_GUIDE.md`
2. **开发进度**：更新对应阶段的 `progress.md`
3. **开发笔记**：更新对应阶段的 `notes.md`
4. **功能完成**：更新 `docs/FEATURES.md` 和 `engines/buildx_core/README.md`

### 如何更新文档

1. **阶段内文档**：在对应阶段的文件夹中更新
2. **跨阶段文档**：在 `docs/` 根目录更新
3. **技术决策**：更新 `docs/DEVELOPER_GUIDE.md`
4. **功能清单**：更新 `docs/FEATURES.md`

## 🎯 项目目标

- **标准化开发**：提供统一的基础功能实现
- **快速启动**：跳过重复的基础开发工作
- **最佳实践**：集成 Rails 社区推荐的最佳实践
- **开箱即用**：包含企业级功能模块

## 🔗 重要链接

- **项目主页**：`README.md`（简单介绍和链接）
- **基础设施详细文档**：`engines/buildx_core/README.md` ⭐ 查看完整文档
- **当前工作**：`CURRENT_WORK.md` ⭐ 每日必看
- **文档索引**：`docs/README.md`
- **功能清单**：`docs/FEATURES.md`
- **开发计划**：`docs/DEVELOPMENT_PLAN.md`
- **开发者指南**：`docs/DEVELOPER_GUIDE.md`
- **规则文件创建指南**：`.cursor/rules/cursor-rules.mdc` ⭐ 创建新规则文件时参考

## ⚠️ 注意事项

1. **每日更新 CURRENT_WORK.md**：开始工作时查看，完成工作后更新
2. **不要重复文档内容**：根目录 `README.md` 保持精简（只做介绍和链接），详细内容在 `engines/buildx_core/README.md`
3. **及时更新进度**：开发过程中及时更新 progress.md 和 CURRENT_WORK.md
4. **记录技术决策**：重要决策记录在 DEVELOPER_GUIDE.md 和对应阶段的 notes.md
5. **遵循开发顺序**：按阶段顺序开发，不要跳跃
6. **业务文档隔离**：业务项目的文档应该放在 `docs/project-[项目名称]/` 目录下，不要修改根目录 `README.md`

## 📖 快速参考

### 当前开发阶段

- **阶段**：第一阶段 - 用户认证系统
- **状态**：进行中
- **文档位置**：`docs/phase-1-authentication/`
- **详细计划**：`docs/phase-1-authentication/plan.md`

### 技术栈核心

- **Ruby**: 3.3.5
- **Rails**: 8.1.1
- **认证**: Rails 8 Authentication Generator + Warden
- **前端**: Tailwind CSS 4 + DaisyUI 5
- **部署**: Kamal + Docker

### 开发规范

- 遵循 Rails 最佳实践
- 使用 RuboCop 代码检查
- 编写测试覆盖（**整体覆盖率要求 85%**，配置在 `test/test_helper.rb`）
  - **重要**：85% 是整体项目的覆盖率要求，不是每个文件都必须达到 100%
  - 特定文件的 100% 覆盖率只是理想目标，不是强制要求
  - 避免为了追求 100% 覆盖率而过度测试，导致项目开发停滞不前
- 文档先行原则
- **第三方库文件存放**：所有从外部下载的第三方库文件（JavaScript、CSS 等）必须存放在 `vendor/` 目录，详见 `docs/DEVELOPER_GUIDE.md`

### 测试覆盖率快速命令

- **用户查看覆盖率报告**：`open coverage/index.html`（在浏览器中打开）
- **AI 分析覆盖率数据**：
  - 读取 `coverage/.resultset.json` 获取详细覆盖率数据
  - 读取 `coverage/.last_run.json` 获取整体覆盖率信息
  - **注意**：AI 必须读取 JSON 文件，不能使用 `open` 命令（AI 无法读取浏览器内容）
- **检查单个文件**：`COVERAGE_FILES=app/models/user.rb bin/rails test test/models/user_test.rb`
- **检查多个文件**：`COVERAGE_FILES=app/models/user.rb,app/controllers/sessions_controller.rb bin/rails test`
- **检查目录**：`COVERAGE_FILES=app/models bin/rails test test/models/`
