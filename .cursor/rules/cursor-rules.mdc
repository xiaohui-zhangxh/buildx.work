---
description: Cursor 规则文件（.mdc 文件）创建和管理指南。当用户提到"规则"、"规则文件"、"创建规则"、"管理规则"、"cursor 规则"、".mdc 文件"等关键词，或需要创建、修改、管理 .cursor/rules/ 目录下的规则文件时参考此规则。说明规则文件的作用、格式、头部元数据字段（description、alwaysApply）的使用方法。注意：这是关于规则文件的指南，不是指令文件（cursor-commands）的指南。
alwaysApply: false
---

# Cursor 规则文件创建指南

## 规则文件的作用

Cursor 规则文件（`.mdc` 文件）用于为 AI 助手提供开发规范和指导。当开发相关功能时，AI 会自动参考这些规则文件，确保遵循最佳实践。

## 规则文件位置

所有规则文件存放在 `.cursor/rules/` 目录下，文件扩展名为 `.mdc`。

## 规则文件格式

### 基本结构

每个规则文件必须包含以下结构：

```markdown
---
description: 规则文件的简短描述
alwaysApply: true 或 false
---

# 规则文件标题

规则内容...
```

### ⚠️ 重要：头部元数据字段

规则文件头部的元数据字段非常重要，它们决定了规则文件如何被 AI 使用。

#### 1. `description` 字段（必需）

**作用**：

- 描述规则文件的内容和用途
- 帮助 AI 理解何时应该参考这个规则文件
- 在规则文件列表中显示，便于查找

**编写规范**：

- ✅ 使用简洁、明确的语言
- ✅ 说明规则文件的主题和用途
- ✅ 说明适用场景（何时参考此规则）
- ✅ 长度建议：50-150 字符

**示例**：

```yaml
# ✅ 好的描述
description: MCP (Model Context Protocol) 开发规则和最佳实践。包含描述信息编写规范、Tool/Resource/Prompt 开发规范、AI 感知机制说明等。开发 MCP 服务器、工具、资源和提示词时参考此规则。

# ✅ 好的描述
description: 认证系统开发规则和参考

# ✅ 好的描述
description: DaisyUI 前端界面 tailwindcss UI组件库

# ❌ 不好的描述（太简短，信息不足）
description: 规则

# ❌ 不好的描述（太冗长）
description: 这是一个关于如何开发 MCP 服务器的规则文件，包含了大量的开发规范和最佳实践，包括描述信息编写规范、Tool 开发规范、Resource 开发规范、Prompt 开发规范、AI 感知机制说明等，当你开发 MCP 相关功能时应该参考这个文件...
```

#### 2. `alwaysApply` 字段（必需）

**作用**：

- 控制规则文件是否总是被 AI 参考
- `true`：规则文件总是被应用，无论上下文如何
- `false`：规则文件只在相关上下文时被应用

**使用建议**：

##### `alwaysApply: true` - 适用于：

- ✅ **通用基础规则**：如 `base.mdc`，包含通用的基础规范和工具使用方法
- ✅ **项目特定规则**：如 `workspace.mdc`，包含项目特定的文档结构和开发流程
- ✅ **通用开发规范**：适用于所有开发场景的规则
- ✅ **核心原则**：项目必须遵循的核心原则

**示例**：

```yaml
---
description: 通用基础规则。包含文档更新规范、Markdown 格式规范、常用工具使用方法等通用规则
alwaysApply: true
---
```

```yaml
---
description: BuildX 项目特定规则和文档索引。包含项目文档结构、开发流程、技术栈信息等
alwaysApply: true
---
```

##### `alwaysApply: false` - 适用于：

- ✅ **特定功能模块规则**：如 `authentication.mdc`、`mcp.mdc`
- ✅ **技术栈相关规则**：如 `daisy-ui.mdc`、`rails-caching.mdc`
- ✅ **按需参考的规则**：只在开发相关功能时才需要参考

**为什么使用 `false`**：

1. **提高效率**：避免 AI 在无关上下文中加载不必要的规则
2. **减少干扰**：只在需要时才应用相关规则，保持上下文清晰
3. **更好的性能**：减少规则文件数量，提高 AI 响应速度

**示例**：

```yaml
---
description: MCP (Model Context Protocol) 开发规则和最佳实践
alwaysApply: false
---
```

## 创建新规则文件的步骤

### 1. 确定规则文件主题

- 是否已有相关规则文件？
- 是否需要创建新的规则文件？
- 规则文件应该包含哪些内容？

### 2. 创建规则文件

在 `.cursor/rules/` 目录下创建新的 `.mdc` 文件：

```bash
touch .cursor/rules/my-rule.mdc
```

### 3. 编写头部元数据

```markdown
---
description: 规则文件的简短描述，说明内容和用途
alwaysApply: false  # 大多数情况下使用 false
---
```

**关键要点**：

- ✅ `description` 必须清晰说明规则文件的用途
- ✅ 大多数情况下使用 `alwaysApply: false`
- ✅ 只有通用基础规则和项目特定规则使用 `alwaysApply: true`

### 4. 编写规则内容

规则内容应该包括：

- **核心原则**：规则文件遵循的核心原则
- **参考文件**：相关的文档和代码文件
- **开发规范**：具体的开发规范和最佳实践
- **示例代码**：示例代码和反例对比
- **常见任务**：常见开发任务的步骤
- **注意事项**：重要的注意事项和陷阱

### 5. 更新相关引用

如果创建了新规则文件，需要更新：

- `workspace.mdc`：在"重要链接"部分添加新规则文件的引用（如果是项目特定规则）
- `docs/README.md`：如果规则文件有对应的文档，添加链接

## 规则文件命名规范

### 命名建议

- ✅ 使用小写字母和连字符：`my-rule.mdc`
- ✅ 使用描述性名称：`authentication.mdc`、`mcp.mdc`
- ✅ 避免使用下划线：`my_rule.mdc`（不推荐）
- ✅ 避免使用空格：`my rule.mdc`（不推荐）

### 命名示例

```
✅ authentication.mdc      # 认证系统规则
✅ mcp.mdc                # MCP 开发规则
✅ daisy-ui.mdc           # DaisyUI 规则
✅ rails-caching.mdc      # Rails 缓存规则
✅ action-policy.mdc      # Action Policy 规则
✅ cursor-rules.mdc       # 规则文件创建指南（本文件）

❌ Authentication.mdc     # 不应使用大写
❌ mcp_rule.mdc          # 避免使用下划线
❌ my rule.mdc           # 避免使用空格
```

## 规则文件内容组织

### 推荐结构

```markdown
---
description: 规则文件描述
alwaysApply: false
---

# 规则文件标题

## 核心原则

规则文件遵循的核心原则...

## 开发相关功能时的参考文件

### 1. 主要文档

**文件位置**：`docs/xxx.md`
**用途**：...

### 2. 相关代码

**文件位置**：`app/xxx/xxx.rb`
**用途**：...

## 开发规范

### 代码规范示例

```ruby
# 示例代码
```

## 常见任务

### 任务 1：...

步骤说明...

## 注意事项

1. 注意事项 1
2. 注意事项 2

## 相关文件索引

- 文档：`docs/xxx.md`
- 代码：`app/xxx/xxx.rb`
```

## 最佳实践

### 1. description 字段编写

- ✅ **清晰明确**：一句话说明规则文件的用途
- ✅ **包含关键词**：包含相关的技术关键词，便于 AI 识别
- ✅ **说明适用场景**：说明何时应该参考此规则
- ✅ **长度适中**：50-150 字符，既不过短也不过长

### 2. alwaysApply 字段选择

- ✅ **默认使用 false**：大多数规则文件应该使用 `false`
- ✅ **谨慎使用 true**：只有项目基础规则使用 `true`
- ✅ **考虑性能**：`true` 会增加 AI 的上下文负担

### 3. 规则内容编写

- ✅ **结构清晰**：使用清晰的标题和章节
- ✅ **示例丰富**：提供好的示例和反例对比
- ✅ **实用为主**：关注实际开发中的常见场景
- ✅ **及时更新**：随着项目发展及时更新规则

### 4. 规则文件维护

- ✅ **定期审查**：检查规则文件是否仍然适用
- ✅ **合并重复**：避免多个规则文件包含重复内容
- ✅ **更新引用**：更新相关文档和代码的引用

## 现有规则文件参考

### 基础规则（alwaysApply: true）

- **base.mdc**：通用基础规则，包含文档更新规范、常用工具使用方法等通用规则
- **workspace.mdc**：Baklib 工作区项目特定规则，包含工作区目录结构、项目列表、任务执行流程等
- **markdown-formatting.mdc**：Markdown 格式编写规范，确保 Markdown 文件在前端渲染时格式正确

### 按需使用的规则（alwaysApply: false）

- **changelog.mdc**：项目更新日志（CHANGELOG.md）创建和管理指南
- **sop.mdc**：项目工作规范（SOP.md）创建和管理指南
- **cursor-rules.mdc**：规则文件（.mdc 文件）创建和管理指南（本文件）
- **cursor-commands.mdc**：指令文件（.md 文件）创建和管理指南
- **web-scraping.mdc**：网页内容采集规则，优先使用浏览器 MCP 工具
- **mcp-kb-article-html-format.mdc**：MCP 工具创建 Baklib 知识库文章时的 HTML 内容格式规范
- **self-learning.mdc**：AI 自我学习和进化规则

**注意**：上述规则文件列表基于当前工作区的实际文件。其他工作区可能包含不同的规则文件（如功能模块规则、技术栈规则等），应根据实际情况调整。

## 注意事项

1. **description 字段很重要**：AI 依赖这个字段来理解规则文件的用途，必须清晰、准确
2. **alwaysApply 字段很重要**：正确设置这个字段可以：
   - 提高 AI 响应效率
   - 减少不必要的上下文加载
   - 保持上下文清晰
3. **规则文件不是文档**：规则文件应该简洁、实用，详细内容应该放在 `docs/` 目录
4. **及时更新**：随着项目发展，及时更新规则文件，确保内容准确
5. **避免重复**：检查是否已有相关规则文件，避免创建重复的规则

## 相关文件索引

- 通用基础规则：`.cursor/rules/base.mdc`
- 项目特定规则：`.cursor/rules/workspace.mdc`
- 指令文件创建指南：`.cursor/rules/cursor-commands.mdc`
- 文档索引：`docs/README.md`
- 开发者指南：`docs/DEVELOPER_GUIDE.md`
