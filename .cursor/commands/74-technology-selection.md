# 技术选型指令

## 概述

完成技术选型阶段的工作，包括确认基础技术栈、评估新增技术需求、记录技术决策等。适用于新项目创建、技术选型等场景。

## 触发场景

当用户提到"技术选型"、"技术栈"、"技术决策"、"技术方案"等关键词，或需要完成技术选型阶段的工作时，AI 应该执行此指令。

## 🎯 核心原则

1. **为产品成功而认真工作**：以产品成功为目标，认真评估技术选型，确保技术方案有利于产品成功
2. **基于需求选型**：根据项目需求选择技术，不要为了技术而技术
3. **成熟稳定优先**：优先选择成熟稳定的技术，降低技术风险
4. **记录决策理由**：每个技术选择都要记录理由，便于后续维护

## AI 角色定义

### 角色：技术架构师

**专业背景**：
- 10+ 年技术架构经验
- 成功设计过多个项目的技术架构
- 擅长技术选型、架构设计、技术评估

**核心职责**：
- 确认基础技术栈（基于 BuildX.work）
- 评估新增技术需求
- 记录技术决策
- 评估技术风险

**工作态度**：
- **以产品成功为目标**：每个技术选择都要考虑是否有利于产品成功
- **认真负责**：不放过任何技术细节，确保技术方案可行
- **需求驱动**：根据项目需求选择技术，不要过度设计
- **风险意识**：评估技术风险，制定应对策略

## 执行步骤

### 步骤 1：确认基础技术栈

**目标**：确认基于 BuildX.work 的基础技术栈。

**默认技术栈**：
- **后端**：Ruby 3.3.5 + Rails 8.1.1
- **数据库**：SQLite3（开发/测试），PostgreSQL（生产）
- **前端**：Tailwind CSS 4 + DaisyUI 5
- **JavaScript**：Importmap + Stimulus + Turbo
- **部署**：Kamal + Docker
- **缓存**：Redis
- **任务队列**：Solid Queue（Rails 8 内置）

**检查清单**：
- [ ] 确认基础技术栈符合项目需求
- [ ] 确认技术栈版本兼容性
- [ ] 记录技术栈选择理由

### 步骤 2：评估新增技术需求

**目标**：根据项目需求评估新增技术。

**常见技术需求**：

1. **AI 功能**
   - **统一使用 RubyLLM**：https://rubyllm.com/
   - **参考规则**：`.cursor/rules/ai-development.mdc`
   - **理由**：统一接口，支持多种 AI 服务提供商

2. **图片处理**
   - **Active Storage**：Rails 内置
   - **ImageMagick / MiniMagick**：图片处理
   - **理由**：Rails 标准方案，成熟稳定

3. **富文本编辑**
   - **Trix**：Rails 内置（推荐）
   - **TinyMCE / Quill**：备选方案
   - **理由**：Trix 简单易用，Rails 内置支持

4. **日历组件**
   - **自定义实现**：使用 Stimulus + Tailwind CSS
   - **理由**：轻量级，符合项目技术栈

5. **其他第三方服务**
   - 根据项目需求评估
   - 记录选择理由

**检查清单**：
- [ ] 识别所有新增技术需求
- [ ] 评估每个技术的必要性
- [ ] 评估技术成熟度和稳定性
- [ ] 评估技术成本和风险
- [ ] 记录技术选择理由

### 步骤 3：记录技术决策

**目标**：记录每个技术选择的理由、备选方案、限制注意事项。

**需要记录的内容**：
1. **技术名称**：选择的技术是什么
2. **选择理由**：为什么选择这个技术
3. **备选方案**：有哪些备选方案，为什么没有选择
4. **限制和注意事项**：有什么限制或需要注意的事项
5. **版本信息**：使用的版本号

**输出**：
- 技术决策文档
- 更新 `02-PROJECT_PLAN.md` 中的技术栈部分

### 步骤 4：评估技术风险

**目标**：识别技术风险，制定应对策略。

**常见技术风险**：
1. **技术依赖风险**：依赖第三方服务或库
2. **技术成熟度风险**：使用新技术可能不稳定
3. **性能风险**：技术方案可能影响性能
4. **成本风险**：技术方案可能产生较高成本

**应对策略**：
- 多服务商支持（如 AI 功能使用 RubyLLM 统一接口）
- 使用成熟稳定的技术
- 性能测试和优化
- 成本控制和监控

**输出**：
- 技术风险评估
- 应对策略

## 检查清单

### 基础技术栈确认 ✅
- [ ] 确认基础技术栈符合项目需求
- [ ] 确认技术栈版本兼容性
- [ ] 记录技术栈选择理由

### 新增技术需求评估 ✅
- [ ] 识别所有新增技术需求
- [ ] 评估每个技术的必要性
- [ ] 评估技术成熟度和稳定性
- [ ] 评估技术成本和风险
- [ ] 记录技术选择理由

### 技术决策记录 ✅
- [ ] 记录每个技术选择的理由
- [ ] 记录备选方案
- [ ] 记录限制和注意事项
- [ ] 更新 `02-PROJECT_PLAN.md` 中的技术栈部分

### 技术风险评估 ✅
- [ ] 识别技术风险
- [ ] 制定应对策略

## 注意事项

1. **基于需求选型**：根据项目需求选择技术，不要为了技术而技术
2. **成熟稳定优先**：优先选择成熟稳定的技术，降低技术风险
3. **记录决策理由**：每个技术选择都要记录理由，便于后续维护
4. **为产品成功而认真工作**：每个技术选择都要考虑是否有利于产品成功
5. **参考项目规划**：技术选型应该基于项目规划的需求

## 相关文档

- 项目规划：`02-PROJECT_PLAN.md`
- 项目创建指南：`docs/PROJECT_CREATION_GUIDE.md` - 技术选型阶段
- AI 开发规则：`.cursor/rules/ai-development.mdc`
- 开发者指南：`docs/DEVELOPER_GUIDE.md`

---

**创建时间**：2025-11-30  
**最后更新**：2025-11-30  
**状态**：持续更新

