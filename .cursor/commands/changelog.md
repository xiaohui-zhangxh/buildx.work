# 更新日志管理指令

## 概述

创建、更新或管理项目更新日志（CHANGELOG.md）文件。适用于记录项目重要变更、任务完成情况、文档更新等场景。

## 触发场景

当用户提到"创建更新日志"、"更新 CHANGELOG"、"记录项目变更"等关键词，或需要创建/更新项目更新日志时，AI 应该执行此指令。

## 🎯 核心原则

1. **及时记录**：重要变更应立即记录，不要积累太多未更新内容
2. **分类清晰**：使用正确的分类标签（新增/变更/修复/移除）
3. **格式统一**：遵循 [Keep a Changelog](https://keepachangelog.com/) 规范
4. **保持简洁**：记录重要变更，避免过于琐碎

## 📁 文件规范

### 文件位置

更新日志文件必须放在**项目根目录**下：

```
[项目目录]/
├── README.md              # 项目说明
├── CHANGELOG.md           # 更新日志（必须）
├── [其他项目文件]
└── [其他项目目录]
```

### 文件命名

- **标准命名**：`CHANGELOG.md`（推荐）
- **备选命名**：`CHANGES.md`、`更新日志.md`（中文项目可用）
- **统一性**：同一工作区的所有项目应使用相同的命名规范

### 文件格式

使用 Markdown 格式，遵循 [Keep a Changelog](https://keepachangelog.com/) 规范。

## 🔍 工作流程

### 第一步：检查文件是否存在

1. **检查项目根目录**：确认是否存在 `CHANGELOG.md` 文件
2. **如果不存在**：创建新的更新日志文件
3. **如果存在**：读取现有内容，准备更新

### 第二步：创建或更新更新日志

#### 如果文件不存在，创建新文件

**基本结构**：

```markdown
# 更新日志

所有重要的项目变更都会记录在此文件中。

格式基于 [Keep a Changelog](https://keepachangelog.com/zh-CN/1.0.0/)，
版本号遵循 [语义化版本](https://semver.org/lang/zh-CN/)。

## [未发布]

### 新增

- 新功能、新任务

### 变更

- 功能调整、任务修改

### 修复

- 问题修复、错误纠正

### 移除

- 删除的功能、取消的任务
```

#### 如果文件存在，更新内容

1. **在 `[未发布]` 部分添加新条目**：
   - 根据变更类型（新增/变更/修复/移除）添加到对应分类
   - 使用清晰的描述说明变更内容
   - 可以添加日期（格式：`YYYY-MM-DD`）

2. **发布新版本时**：
   - 将 `[未发布]` 部分的内容移动到新的版本号部分
   - 添加版本号和日期（格式：`## [版本号] - YYYY-MM-DD`）
   - 清空 `[未发布]` 部分，准备记录新的变更

### 第三步：分类说明

#### 1. 新增（Added）

- 新增的功能、任务、文档
- 新增的文件、目录
- 新增的工具、脚本

#### 2. 变更（Changed）

- 修改的功能、任务
- 更新的文档内容
- 调整的工作流程
- 优化的文件结构

#### 3. 修复（Fixed）

- 修复的问题、错误
- 纠正的文档错误
- 解决的技术问题

#### 4. 移除（Removed）

- 删除的功能、任务
- 移除的文件、目录
- 废弃的工具、脚本

#### 5. 安全（Security）

- 安全相关的更新（如适用）

## 📋 更新时机

### 必须更新的情况

1. **任务完成时**
   - 完成重要任务后立即更新
   - 记录任务完成日期和成果

2. **文档更新时**
   - 更新 `engines/buildx_core/README.md` 后（详细的基础设施文档）
   - 更新项目说明文档后
   - 更新重要配置文件后
   - **注意**：根目录 `README.md` 只做简单介绍和链接，很少需要更新

3. **功能变更时**
   - 新增功能或任务
   - 修改现有功能
   - 删除功能或任务

4. **问题修复时**
   - 修复重要问题后
   - 纠正文档错误后

### 酌情更新的情况

1. **日常任务**
   - 小的文档调整
   - 格式优化
   - 拼写错误修正

2. **阶段性总结**
   - 每周/每月总结时
   - 可以批量更新多条记录

3. **重要里程碑**
   - 项目阶段完成
   - 重要目标达成

## 📝 更新规范

### 日期格式

- **标准格式**：`YYYY-MM-DD`（如：2025-01-15）
- **一致性**：所有日期使用相同格式

### 版本号（可选）

如果项目使用版本号：

- **格式**：遵循语义化版本（Semantic Versioning）
- **示例**：`1.0.0`、`1.1.0`、`2.0.0`

如果项目不使用版本号：

- 可以只使用日期
- 或使用项目阶段标识（如：`Q1-2025`）

### 条目格式

每条更新记录应包含：

- **分类标签**：新增/变更/修复/移除
- **简要描述**：清晰说明变更内容
- **详细信息**（可选）：补充说明、链接等

**示例**：

```markdown
### 新增

- 完成用户认证系统开发（2025-01-15）
- 新增密码重置功能
- 添加邮件通知功能

### 变更

- 更新 `engines/buildx_core/README.md`，添加认证系统说明
- 优化用户注册流程，简化表单字段

### 修复

- 修复用户登录时的会话管理问题
- 纠正密码重置邮件模板中的链接错误
```

## 🎯 更新示例

### 示例1：任务完成更新

```markdown
## [未发布]

### 新增

- 完成用户认证系统开发（2025-01-15）
  - 实现用户注册功能
  - 实现用户登录功能
  - 实现密码重置功能
  - 添加邮件确认功能

### 变更

- 更新 `engines/buildx_core/README.md`，添加认证系统说明
- 优化用户注册流程，简化表单字段

## [1.0.0] - 2025-01-15

### 新增

- 初始化项目结构
- 创建用户认证系统
- 添加邮件通知功能

### 变更

- 完善项目 README 文档
```

### 示例2：文档更新

```markdown
## [未发布]

### 变更

- 更新 `engines/buildx_core/README.md`，添加授权系统说明（2025-01-15）
- 更新开发计划文档，标记已完成任务
- 优化开发者指南，添加测试规范

### 新增

- 新增授权系统开发规则文档
- 添加测试覆盖率跟踪说明
```

### 示例3：阶段性总结

```markdown
## [未发布]

### 新增

- 完成第一阶段开发（2025-01-15）
  - 用户认证系统
  - 用户授权系统
  - 多租户支持
- 新增测试覆盖率跟踪功能

### 变更

- 更新开发计划，完成度提升至30%
- 优化测试流程，提升覆盖率至85%
```

## 重要规则

### 1. 及时更新

- ✅ 重要变更应立即记录
- ✅ 不要积累太多未更新内容
- ✅ 建议每天或每周定期更新

### 2. 保持简洁

- ✅ 记录重要变更，避免过于琐碎
- ✅ 使用清晰简洁的描述
- ✅ 可以合并同类变更

### 3. 保持一致性

- ✅ 使用统一的格式和风格
- ✅ 保持日期格式一致
- ✅ 使用统一的分类标签

### 4. 链接引用

- ✅ 可以链接到相关文件
- ✅ 可以引用任务编号或PR
- ✅ 可以链接到外部资源

### 5. 版本管理

- ✅ 更新日志也应纳入版本控制
- ✅ 重要版本发布时更新日志
- ✅ 保持更新日志的完整性

## 🔗 相关文档

### 与任务管理的关系

- **任务完成**：在更新日志中记录任务完成情况
- **任务进度**：更新日志可以补充任务进度文件的不足
- **任务总结**：定期在更新日志中总结任务进展

### 与 README 的关系

- **README 更新**：在更新日志中记录 `engines/buildx_core/README.md` 的变更（详细的基础设施文档）
- **项目说明**：更新日志可以记录项目说明的变更历史
- **使用指南**：更新日志可以记录使用指南的更新
- **注意**：根目录 `README.md` 只做简单介绍和链接，很少需要更新

### 与其他文档的关系

- **文档更新**：记录重要文档的更新
- **规则变更**：记录项目规则的变更
- **工具更新**：记录工具和脚本的更新

## 注意事项

1. **BuildX 项目特定规范**：
   - `engines/buildx_core/README.md` 是详细的基础设施文档，更新时应记录
   - 根目录 `README.md` 只做简单介绍和链接，很少需要更新

2. **不要过度记录**：
   - 只记录重要变更，避免过于琐碎
   - 小的格式调整、拼写错误修正等可以合并记录

3. **保持格式统一**：
   - 遵循 [Keep a Changelog](https://keepachangelog.com/) 规范
   - 使用统一的日期格式和分类标签

4. **及时发布版本**：
   - 重要里程碑或功能完成时，及时发布新版本
   - 将 `[未发布]` 部分的内容移动到版本号部分

---

**创建时间**：2025-12-01  
**最后更新**：2025-12-01

